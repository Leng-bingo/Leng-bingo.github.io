---
title: 04PAMI总结梳理
top: false
cover: false
toc: false
mathjax: true
tags:
  - 论文
  - 研究生
  - 笔迹鉴定
categories:
  - 论文
summary: 04PAMI总结梳理
abbrlink: bb8d
date: 2021-08-23 18:36:19
password:
keywords:
description:
---
### 04PAMI梳理

#### 1.数据集

- 使用100名书写人作为训练集的CO3码本，使用150名书写人计算CO3的概率密度。

#### 2.模型

- 对于给定的字母表L存在一个有限的异体字列表S，每个异体字$S_{li}$都被认为是字母$l$第i个允许的样式变化。
- 设概率密度函数$p_w(S)$，书写人w书写出异体字的概率。
- 作者认为：书写人不同，则书写异体字的$pdf$就不同。

$$
w \neq v \Rightarrow p_{w}(S) \neq p_{v}(S)
$$

- 书写人w书写的手写样本u的特点是

$$
\vec{x}_{w u}=p_{w u}(S),
$$

- 如果样本u具有代表性，则样本u的特点就可以表示书写人w书写异体字的概率密度函数

$$
\vec{x}_{w u} \approx p_{w}(S) \text {, }
$$

- **作者认为，如果两个书写人是不同的，那么相同书写人的任意两个书写样本之间的一个距离是小于不同书写人的任意两个样本之间的距离。**

$$
\forall a, b, c, w, v \neq w: \Delta\left(\vec{x}_{w a}, \vec{x}_{w b}\right)<\Delta\left(\vec{x}_{w a}, \vec{x}_{v c}\right),
$$

  - $\Delta$是概率密度函数上的一个适当距离函数$\vec{x}$，v和w表示书写人，a，b，c是手写样本或者是手写的特征。
  - 假设每个异形字符都由一组非空的连接组件$c_j$组成,$S_{l i}=\left\{c_{1}, c_{2}, \ldots, c_{m}\right\}$,我们**假设**所有可能的异形字符都可以由有限集或码本C的连通组件表示。此外，如果我们**假设**连通组件的形状是异体字符变体的信息，那么对于概率函数。**书写人w书写的内容u的连通组件的概率密度等于书写人w书写内容u的概率密度。**

$$
\vec{\xi}_{w u}=p_{w u}(C)
$$

- 书写人w从手写样本u中导出连通组件，和公式4类似

$$
\forall a, b, c, w, v \neq w: \Delta\left(\vec{\xi}_{w a}, \vec{\xi}_{w b}\right)<\Delta\left(\vec{\xi}_{w a}, \vec{\xi}_{v c}\right)
$$

- 假设样本u具有代表性，则：**（连通组件的概率密度就可以表示书写人w的特征）**

$$
\vec{\xi}_{w u} \approx p_{w}(C)
$$

#### 3.方法

##### 3.1数据

- **共250个段落。第一组为100个段落，尽可能多的书写人来训练。第二组为150个段落，由同样多的书写人但是不同书写人来作为测试组。**

##### 3.2步骤一：用大写笔迹计算连通元件轮廓码本

- 对100个段落进行图像预处理，使用3x3**平滑**窗口对灰度图像进行**模糊**处理。然后再使用中点灰度值进行二值化，对于每个连接的组件，使用**摩尔计算法**计算轮廓。从最左边像素逆时针开始，对轮廓坐标开始记录，生成100个（x，y）坐标对。得到200维向量被称作**连接组件轮廓**COnnected-COmponent COntour (COCOCO or CO^3^)。**（一个点的轮廓有100个坐标，200维向量，为一个连接组件）**
  - 图像平滑的目的：
    - 模糊：在提取较大目标前，去除小细节或者将目标内的小间断连接起来（论文用的这个）
    - 消除噪声：改善图片质量，降低干扰
  - 摩尔邻域计算法：
    - 摩尔邻域也称为8邻域
    - 先找到一个黑色像素，将它认定为你的起始像素。
    - 以顺时针方向搜索摩尔邻域内的每一个像素，直到遇到下一个黑色像素。
    - 行走到初始点时，走过的黑色像素就是目标的边缘。
- 100个段落产生了26896个连接组件轮廓，这些连接组件轮廓被用于33x33的**自组织特征映射SOFM神经网络**（应用于竞争学习而不是纠错学习）。
  - 自组织特征映射SOFM：一个神经网络接受外界输入模式时， 将会分为不同的对应区域， 各区域对输入模式具有不同的响应特征，而且这个过程是自动完成的。 自组织特征映射正是根据这一看法提出来的 ，其特点与人脑的自组织特性相类似。（神经网络，最后一天看这个）
    - 拓扑结构：SOFM网有两层，输入层神经元通过权重向量将外界信息汇集到输出层的神经元。输入层的神经元数与样本维数相等。
    - SOFM采用的学习算法为**Kohonen算法**，用大量训练样本调整网络的权值。SOFM网获胜的神经元不仅获胜的神经元本身调整权重，周围神经元也要调整权重。
    - 每个节点大概25个样本（26896/33/33=24.69），程序的目标是为了产生精确的CO3形状，而不是为了以**拓扑保持**为目标。

##### 3.3步骤二：计算特定书写人的特征向量

- 150名书写人，计算每个书写人，利用**欧几里得最近邻**搜索计算笔迹中CO3特征在SOFM中的节点出现情况的直方图。（求出书写人的CO3特征，与码本进行比较，与谁最像就选谁，然后计算选出最像的距离，求出概率密度，直方图。最后再做比较）

$$
\begin{array}{l}
\vec{\xi} \leftarrow 0 \\
forall \quad i \in \mathcal{K} \\
\{ \\
\quad \vec{x}_{i} \leftarrow\left(\vec{x}_{i}-\mu_{x}\right) / \sigma_{r} \\
\quad \vec{y}_{i} \leftarrow\left(\vec{y}_{i}-\mu_{y}\right) / \sigma_{r} \\
\quad \vec{f}_{i} \leftarrow\left(X_{i 1}, Y_{i 1}, X_{i 2}, Y_{i 2} \ldots, X_{i 100}, Y_{i 100}\right) \\
\quad k \leftarrow \operatorname{argmin}_{l}\left\|\vec{f}_{i}-\vec{\lambda}_{l}\right\| \\
\quad \Xi_{k} \leftarrow \Xi_{k}+1 / N \\
\}
\end{array}
$$

- $\vec{\xi}$是连接组件CO3的概率密度函数，$\mathcal{K}$是测试集样本中检测到的连接组件集
  - 首先，将连接组件概率密度设为0
  - 每个轮廓的坐标归一化再标准化（x-u/方差）
  - $\overrightarrow{f_{i}}$为100个标准化后的轮廓xy值。
  - 在学习完毕的Kohonen-SOFM向量权重表中，寻找f的欧氏最近邻的索引k
  - PDF的k中的对应值被更新以最终获得p（CO3）
  - 该概率密度被假定为一个书写人的描述，包含给定书写人的连接组件形状。

##### 3.4步骤三：书写人识别

- 150位书写人的150个段落被分成上半部A和下半部B。分别为每个书写人计算p（CO3）组件轮廓的概率，集合A和B都计算。使用卡方距离测量。对于集合B中的每个书写人描述符，搜索集合A中的最近邻。

$$
\chi_{i j}^{2}=\sum_{k=1}^{n} \frac{\left(\xi_{k i}-\xi_{k j}\right)^{2}}{\xi_{k i}+\xi_{k j}}
$$

- i和j是样本索引，k是**bin index**，n表示pdf中**bin**的数量，${\xi}$表示CO3码本的概率。

- 使用卡方距离（点与期望的差除以期望的平方价格开根号）的优点是，概率密度函数中低概率区域的差异比简单欧几里德距离度量更好，也比**Bhattacharya距离**更好。
  - 巴式距离，测量的是两个离散或连续概率分布的相似性。

![](https://leng-mypic.oss-cn-beijing.aliyuncs.com/20210823130705.png)

- 上图为提取出来的轮廓的密度图，每个单元表示33X33的Kohonen码本中的CO3的概率密度，相同书写人密度就大，不同书写人，相同的很少。

#### 4.结果

- 根据100组训练集得出的码本，计算测试集笔迹所对应的连接组件的概率密度，比较即可。

- 使用N=150个书写人的独立测试集。测试方法如下：对于测试集中的每个书写人，一个段落设为A，不同的段落设为B。测试的目的是为每个书写人从A中找到相应的段落B。
- 名为AB的测试是指一种保留一个的方法，所有A和B样本集都在一个集合中，一个接一个的取出查询样本，这意味着对A查询，样本B将变成目标。（先算一个，然后慢慢找剩下的299个）
- 名为“AvsB”的测试基于传统的不相交集，其中目标集只包含来自每个书写人的单个样本。因此，查询的干扰因素数量要少得多：150-1，命中的先验概率等于1/150。因此，不相交的“a vs B”测试将产生比更现实的漏掉一个的“AB”测试更好的结果。（把A和B分开，算一个A，从剩下的150个B中找）












